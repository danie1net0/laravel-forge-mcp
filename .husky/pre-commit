#!/usr/bin/env sh
. "$(dirname "$0")/common.sh"

# Verifica se √© merge
if git rev-parse -q --verify MERGE_HEAD > /dev/null 2>&1; then
    exit 0
fi

# Recupera arquivos em staging
STAGED_FILES=$(git diff --cached --name-only)

# Aborta a execu√ß√£o caso a √°rea de staging esteja limpa
if [ -z "$STAGED_FILES" ]; then
    exit 0
fi

# Executa formata√ß√£o
echo "üîç Formatando c√≥digo PHP com Pint..."
run_php vendor/bin/pint

echo "üé® Formatando c√≥digo frontend com Prettier..."
npm run prettier

# Re-adiciona arquivos formatados
git add $STAGED_FILES

echo "‚úÖ C√≥digo formatado com sucesso!"
